<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pomelita | Takƒ± Koleksiyonu</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Sacramento&family=Quicksand:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root { --bg-body: #ffffff; --color-purple: #9F8CC2; --color-mint: #98DDCA; --color-pink: #FFB7B2; --text-dark: #4a4a4a; --bg-soft-purple: #F4F0FF; --bg-soft-peach: #FFF5EB; }
        body { margin: 0; padding: 0; background-color: var(--bg-body); font-family: 'Quicksand', sans-serif; color: var(--text-dark); overflow-x: hidden; }
        .brand-font { font-family: 'Sacramento', cursive; font-weight: 400; letter-spacing: 1px; font-size: 3.5rem; }
        .btn-add { width: 100%; padding: 12px 0; background-color: var(--color-mint); color: white; border: 2px solid var(--color-mint); text-transform: uppercase; font-size: 12px; letter-spacing: 1px; cursor: pointer; transition: 0.3s; font-weight: 700; border-radius: 12px; }
        .btn-add:hover { background-color: white; color: var(--color-mint); }
        .reveal { opacity: 0; transform: scale(1.05) translateY(20px); transition: all 1s cubic-bezier(0.25, 0.46, 0.45, 0.94); }
        .reveal.active { opacity: 1; transform: scale(1) translateY(0); }
        .nav-link-effect { display: inline-block; position: relative; color: var(--text-dark); text-decoration: none; transition: 0.3s; font-weight: 600; }
        .nav-link-effect::after { content: ''; position: absolute; width: 100%; transform: scaleX(0); height: 3px; bottom: -2px; left: 0; background-color: var(--color-purple); transform-origin: bottom right; transition: transform 0.3s ease-out; border-radius: 2px; }
        .nav-link-effect:hover::after { transform: scaleX(1); transform-origin: bottom left; }
        .nav-link-effect:hover { color: var(--color-purple); transform: scale(1.05); }
        .dropdown { position: relative; display: inline-block; height: 100%; }
        .dropdown-content { display: none; position: absolute; top: 35px; left: -150px; background-color: white; min-width: 800px; box-shadow: 0 20px 50px rgba(159, 140, 194, 0.2); z-index: 2000; border: 2px solid #f0f0f0; border-radius: 15px; padding: 20px; animation: fadeIn 0.4s ease; }
        .dropdown:hover .dropdown-content { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .category-hero { height: 350px; background-color: #f3f4f6; display: flex; align-items: center; justify-content: center; text-align: center; background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url('isgorselleri/model1.png'); background-size: cover; background-position: center 30%; background-attachment: fixed; border-radius: 0 0 30px 30px; }
        .category-hero h1 { color: white; font-size: 6rem; text-shadow: 0 4px 15px rgba(0,0,0,0.6); }
        .products-wrapper { background-color: var(--bg-soft-purple); padding: 60px 0; }
        .products-section { max-width: 1400px; margin: 0 auto; padding: 0 30px; }
        .grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 30px; }
        .product-card { background: white; position: relative; cursor: pointer; transition: transform 0.5s ease; border-radius: 15px; overflow: hidden; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        .product-card:hover { transform: translateY(-10px); box-shadow: 0 15px 30px rgba(0,0,0,0.1); }
        .img-wrap { width: 100%; height: 400px; overflow: hidden; background-color: #f9f9f9; }
        .img-wrap img { width: 100%; height: 100%; object-fit: cover; transition: 0.5s; }
        .product-card:hover .img-wrap img { transform: scale(1.05); }
        .info-wrap { padding: 20px; text-align: center; }
        .p-title { font-size: 15px; color: var(--text-dark); margin-bottom: 8px; font-weight: 600; }
        .p-price { font-size: 17px; font-weight: 700; color: var(--color-purple); margin-bottom: 15px; }
        .filter-bar { display: flex; justify-content: space-between; align-items: center; padding: 20px 0; border-bottom: 1px solid #eee; margin-bottom: 40px; background-color: white; padding: 20px; border-radius: 15px; }
        .marquee-strip { background-color: var(--color-pink); color: white; padding: 18px 0; overflow: hidden; white-space: nowrap; }
        .marquee-content { display: inline-block; animation: scroll 25s linear infinite; font-size: 18px; font-weight: 700; text-transform: uppercase; letter-spacing: 2px; }
        @keyframes scroll { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }
        @media (max-width: 1024px) { .grid { grid-template-columns: repeat(2, 1fr); gap: 15px; } .img-wrap { height: 250px; } .category-hero h1 { font-size: 4rem; } .dropdown-content { display: none !important; } }
        #cart-sidebar { transition: transform 0.3s ease-in-out; }
        #toast { transition: transform 0.3s cubic-bezier(0.68, -0.55, 0.27, 1.55); }
    </style>
</head>
<body>
    <div id="toast" class="fixed top-24 right-5 bg-white border-l-4 border-green-400 px-6 py-4 rounded shadow-2xl transform translate-x-[150%] z-[3000] flex items-center gap-4">
        <div class="text-green-500 text-2xl"><i class="fas fa-check-circle"></i></div>
        <div><h4 class="font-bold text-gray-800 text-sm">Ba≈üarƒ±lƒ±!</h4><p class="text-xs text-gray-500">√úr√ºn sepete eklendi.</p></div>
    </div>

    <div id="cart-sidebar" class="fixed top-0 right-0 h-full w-96 bg-white shadow-2xl z-[2500] transform translate-x-full flex flex-col">
        <div class="p-6 border-b flex justify-between items-center bg-gray-50"><h2 class="font-bold text-xl text-gray-800 font-serif">Sepetim (<span class="badge-count">0</span>)</h2><button id="close-cart" class="text-gray-400 hover:text-red-500 transition"><i class="fas fa-times text-2xl"></i></button></div>
        <div id="cart-items" class="flex-1 overflow-y-auto p-6 space-y-6"></div>
        <div class="p-6 border-t bg-gray-50 space-y-3">
            <div class="flex justify-between text-lg font-bold text-gray-800"><span>Toplam:</span><span id="cart-total">0,00 TL</span></div>
            <button onclick="clearCart()" class="w-full bg-red-100 text-red-500 py-3 rounded-xl font-bold hover:bg-red-200 transition text-sm">SEPETƒ∞ BO≈ûALT</button>
            <button onclick="window.location.href='odeme.html'" class="w-full bg-green-700 text-white py-4 rounded-xl font-bold hover:bg-green-800 transition shadow-lg">√ñDEMEYE GE√á</button>
        </div>
    </div>
    <div id="cart-overlay" class="fixed inset-0 bg-black bg-opacity-40 z-[2400] hidden backdrop-blur-sm"></div>

    <nav class="fixed top-0 left-0 w-full bg-white/95 backdrop-blur-md z-50 border-b border-gray-100 px-10 py-5 flex justify-between items-center reveal">
        <button id="mobile-menu-btn" class="lg:hidden text-2xl text-gray-700"><i class="fas fa-bars"></i></button>
        <div class="hidden lg:flex gap-8 text-lg font-bold uppercase tracking-widest items-center" style="color: var(--text-dark);">
            <a href="index.html" class="nav-link-effect">Ana Sayfa</a>
            <div class="dropdown">
                <a href="#" class="nav-link-effect" style="cursor: default;">Kategoriler <i class="fas fa-chevron-down text-xs ml-1"></i></a>
                <div class="dropdown-content">
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px;">
                        <a href="kategori.html?kat=anneler" style="display:block;"><img src="isgorselleri/kupe1.png" style="width:100%; height:100%; object-fit:cover;"><span style="display:block; margin-top:5px; font-weight:700; color:var(--color-purple);">Anneler G√ºn√º</span></a>
                        <a href="kategori.html?kat=sevgililer" style="display:block;"><img src="isgorselleri/kupe2.png" style="width:100%; height:100%; object-fit:cover;"><span style="display:block; margin-top:5px; font-weight:700; color:var(--color-purple);">Sevgililer G√ºn√º</span></a>
                        <a href="kategori.html?kat=vazolar" style="display:block;"><img src="isgorselleri/kupe3.png" style="width:100%; height:100%; object-fit:cover;"><span style="display:block; margin-top:5px; font-weight:700; color:var(--color-purple);">Vazolar</span></a>
                        <a href="kategori.html?kat=standlar" style="display:block;"><img src="isgorselleri/gomlek.png" style="width:100%; height:100%; object-fit:cover;"><span style="display:block; margin-top:5px; font-weight:700; color:var(--color-purple);">Standlar</span></a>
                    </div>
                </div>
            </div>
        </div>
        <div class="text-5xl brand-font" style="color: var(--color-purple); line-height: 1;">
            <a href="index.html" style="text-decoration:none; color:inherit;">Pomelita</a>
        </div>
        <div class="flex items-center gap-8 text-lg font-bold uppercase tracking-widest" style="color: var(--text-dark);">
            <div class="hidden md:flex gap-8">
                <a href="takilar.html" class="nav-link-effect border-b-2" style="border-color: var(--color-purple);">Takƒ±lar</a>
                <a href="atolye.html" class="nav-link-effect">At√∂lye</a>
            </div>
            <div class="flex items-center gap-5 text-xl">
                <button class="hover:text-purple-400 transition transform hover:scale-110"><i class="fas fa-search"></i></button>
                <button id="cart-btn-desktop" class="hover:text-purple-400 transition relative transform hover:scale-110"><i class="fas fa-shopping-bag"></i><span class="absolute -top-2 -right-2 bg-purple-400 text-white text-[10px] w-5 h-5 flex items-center justify-center rounded-full badge-count">0</span></button>
            </div>
        </div>
        <div class="lg:hidden flex items-center gap-4 text-xl">
             <button id="cart-btn-mobile" class="relative"><i class="fas fa-shopping-bag"></i><span class="absolute -top-2 -right-2 bg-purple-400 text-white text-[10px] w-4 h-4 flex items-center justify-center rounded-full badge-count">0</span></button>
        </div>
    </nav>

    <div id="mobile-menu" class="fixed top-0 left-0 w-3/4 h-full bg-white z-[60] shadow-2xl p-6 flex flex-col gap-6 transform -translate-x-full transition-transform duration-300">
        <div class="flex justify-between items-center mb-4"><span class="brand-font text-3xl text-purple-400">Pomelita</span><button id="close-menu-btn" class="text-2xl"><i class="fas fa-times"></i></button></div>
        <a href="index.html" class="text-lg font-bold text-gray-700 border-b pb-2">ANA SAYFA</a>
        <a href="takilar.html" class="text-lg font-bold text-gray-700 border-b pb-2">TAKILAR</a>
        <a href="atolye.html" class="text-lg font-bold text-gray-700 border-b pb-2">AT√ñLYE</a>
    </div>
    <div id="menu-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-[55] hidden"></div>

    <div class="marquee-strip reveal mt-20 lg:mt-24"><div class="marquee-content">‚ú® YENƒ∞ √úR√úNLER GELDƒ∞ &nbsp;&nbsp;‚Ä¢&nbsp;&nbsp; üë©‚Äçüé® KADIN Gƒ∞Rƒ∞≈ûƒ∞MCƒ∞ &nbsp;&nbsp;‚Ä¢&nbsp;&nbsp; üì¶ √úCRETSƒ∞Z KARGO &nbsp;&nbsp;‚Ä¢&nbsp;&nbsp; üíñ STƒ∞Lƒ∞Nƒ∞ Y√úKSELT &nbsp;&nbsp;‚Ä¢&nbsp;&nbsp; ‚ú® YENƒ∞ √úR√úNLER GELDƒ∞</div></div>

    <header class="category-hero reveal">
        <div><h1 class="brand-font mb-2 reveal">Takƒ± Koleksiyonu</h1><p class="text-white text-lg tracking-widest uppercase font-bold reveal">Zarafetin En Saf Hali</p></div>
    </header>

    <div class="products-wrapper reveal">
        <section class="products-section">
            <div class="filter-bar">
                <span class="font-medium" style="color: var(--color-purple);"><span id="p-count">0</span> √úr√ºn Listeleniyor</span>
                <div class="flex items-center gap-4"><span class="text-sm font-bold uppercase tracking-wide">Sƒ±rala:</span><select class="border border-gray-300 p-2 text-sm bg-white outline-none focus:border-purple-400 rounded-md"><option>√ñnerilen</option><option>Fiyat Artan</option></select></div>
            </div>

            <div id="dynamic-grid" class="grid"></div>
        </section>
    </div>

    <script>
        // --- Dƒ∞NAMƒ∞K √úR√úN Y√úKLEME ---
        async function loadProducts() {
            try {
                const response = await fetch('/api/urunler');
                const products = await response.json();
                const grid = document.getElementById('dynamic-grid');
                const countEl = document.getElementById('p-count');

                countEl.innerText = products.length;

                if (products.length === 0) {
                    grid.innerHTML = '<div class="col-span-4 text-center py-20 text-gray-400 font-bold">Hen√ºz √ºr√ºn eklenmemi≈ü.<br>Admin panelinden √ºr√ºn ekleyebilirsiniz.</div>';
                    return;
                }

                grid.innerHTML = products.map(p => `
                    <a href="urun-detay.html?id=${p.id}" class="block no-underline text-inherit reveal active">
                        <div class="product-card">
                            <div class="img-wrap">
                                <img src="${p.img}" alt="${p.title}" onerror="this.src='https://via.placeholder.com/300?text=Resim+Yok'">
                            </div>
                            <div class="info-wrap">
                                <div class="p-title">${p.title}</div>
                                <div class="p-price">${p.price}</div>
                                <button class="btn-add" 
                                    data-id="${p.id}" 
                                    data-title="${p.title}" 
                                    data-price="${p.price}" 
                                    data-img="${p.img}">Sepete Ekle</button>
                            </div>
                        </div>
                    </a>
                `).join('');

                // Butonlara tƒ±klandƒ±ƒüƒ±nda detaya gitmesin, sadece sepete eklesin
                bindCartButtons();

            } catch (error) {
                console.error("√úr√ºnler y√ºklenirken hata olu≈ütu:", error);
            }
        }

        // --- SEPET MANTIƒûI ---
        let sepet = JSON.parse(localStorage.getItem('pomelitaSepet')) || [];
        const cartSidebar = document.getElementById('cart-sidebar');
        const cartOverlay = document.getElementById('cart-overlay');
        const closeCartBtn = document.getElementById('close-cart');
        const openCartBtn = document.getElementById('cart-btn-desktop');
        const openCartBtnMobile = document.getElementById('cart-btn-mobile');

        function toggleCart() { cartSidebar.classList.toggle('translate-x-full'); cartOverlay.classList.toggle('hidden'); if (!cartSidebar.classList.contains('translate-x-full')) renderCart(); }
        if(openCartBtn) openCartBtn.addEventListener('click', toggleCart);
        if(openCartBtnMobile) openCartBtnMobile.addEventListener('click', toggleCart);
        if(closeCartBtn) closeCartBtn.addEventListener('click', toggleCart);
        if(cartOverlay) cartOverlay.addEventListener('click', toggleCart);

        function showToast() { const toast = document.getElementById('toast'); toast.classList.remove('translate-x-[150%]'); setTimeout(() => { toast.classList.add('translate-x-[150%]'); }, 3000); }
        function updateCart() { localStorage.setItem('pomelitaSepet', JSON.stringify(sepet)); const totalCount = sepet.reduce((acc, item) => acc + item.adet, 0); document.querySelectorAll('.badge-count').forEach(el => el.innerText = totalCount); }
        
        function renderCart() {
            const container = document.getElementById('cart-items');
            const totalEl = document.getElementById('cart-total');
            if (sepet.length === 0) { container.innerHTML = '<div class="text-center text-gray-400 mt-10">Sepet bo≈ü</div>'; totalEl.innerText = '0,00 TL'; return; }
            let total = 0;
            container.innerHTML = sepet.map(item => {
                let priceNum = parseFloat(item.price.replace('TL','').replace('.','').replace(',','.'));
                if(isNaN(priceNum)) priceNum = 0;
                total += priceNum * item.adet;
                let itemTotal = (priceNum * item.adet).toLocaleString('tr-TR', {minimumFractionDigits: 2, maximumFractionDigits: 2});
                return `<div class="flex gap-4 items-center border-b pb-4 last:border-0"><img src="${item.img}" class="w-16 h-16 object-cover rounded-md border"><div class="flex-1"><h4 class="text-sm font-bold text-gray-800 line-clamp-1">${item.title}</h4><p class="text-xs text-gray-500">${item.price}</p><div class="flex items-center gap-3 mt-2"><button onclick="changeQty('${item.id}', -1)" class="w-6 h-6 bg-gray-100 rounded-full text-xs font-bold hover:bg-gray-200">-</button><span class="text-sm font-semibold">${item.adet}</span><button onclick="changeQty('${item.id}', 1)" class="w-6 h-6 bg-gray-100 rounded-full text-xs font-bold hover:bg-gray-200">+</button></div></div><div class="text-right flex flex-col items-end"><p class="font-bold text-sm text-green-600">${itemTotal} TL</p><button onclick="removeItem('${item.id}')" class="text-xs text-red-400 underline mt-1">Sil</button></div></div>`;
            }).join('');
            totalEl.innerText = total.toLocaleString('tr-TR', {minimumFractionDigits: 2, maximumFractionDigits: 2}) + ' TL';
        }
        window.changeQty = function(id, change) { const item = sepet.find(i => i.id === id); if (item) { item.adet += change; if (item.adet <= 0) sepet = sepet.filter(i => i.id !== id); updateCart(); renderCart(); } };
        window.removeItem = function(id) { sepet = sepet.filter(i => i.id !== id); updateCart(); renderCart(); }
        window.clearCart = function() { sepet = []; updateCart(); renderCart(); }
        
        function addToCart(id, title, price, img) {
            const existingItem = sepet.find(item => item.id === id);
            if (existingItem) existingItem.adet++; else sepet.push({ id, title, price, img, adet: 1 });
            updateCart(); showToast(); renderCart();
        }

        // Dƒ∞NAMƒ∞K BUTON BAƒûLAMA
        function bindCartButtons() {
            document.querySelectorAll('.btn-add').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault(); e.stopPropagation();
                    const id = this.getAttribute('data-id');
                    const title = this.getAttribute('data-title');
                    const price = this.getAttribute('data-price');
                    const img = this.getAttribute('data-img');
                    addToCart(id, title, price, img);
                });
            });
        }

        // Reveal Animations
        const observer = new IntersectionObserver((entries) => { entries.forEach((entry) => { if (entry.isIntersecting) { entry.target.classList.add('active'); } }); }, { threshold: 0.1 });
        document.querySelectorAll('.reveal').forEach((el) => observer.observe(el));

        // Mobile Menu
        const menuBtn = document.getElementById('mobile-menu-btn');
        const closeBtn = document.getElementById('close-menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');
        const overlay = document.getElementById('menu-overlay');
        function toggleMenu() { mobileMenu.classList.toggle('-translate-x-full'); if(!mobileMenu.classList.contains('-translate-x-full')) overlay.classList.remove('hidden'); else overlay.classList.add('hidden'); }
        if(menuBtn) menuBtn.addEventListener('click', toggleMenu);
        if(closeBtn) closeBtn.addEventListener('click', toggleMenu);
        if(overlay) overlay.addEventListener('click', toggleMenu);

        // SAYFA Y√úKLENƒ∞NCE
        updateCart();
        loadProducts(); // Verileri √áek
    </script>
</body>
</html>